{% extends 'base.html.twig' %}

{% set title = "Collections Blender" %}
{% set meta_description = "Explorez une sélection organisée des meilleurs add-ons gratuits pour Blender." %}
{% block meta_robots %}index, follow{% endblock %}
{% block og_type %}website{% endblock %}

{% block body %}
<main class="min-h-screen w-full lg:w-3/4 flex flex-col items-center py-12 px-4 gap-12 dark:bg-black-900 bg-white-muted">
    <section class=" flex flex-row gap-4 items-center justify-center py-4 border-t border-grey-800 first:border-none">
        <svg width="74" class=" dark:text-white " viewBox="0 0 90 73" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M27.566 47.1031C27.5886 48.2743 27.963 50.5536 28.5225 52.3328C29.7364 56.1677 31.7752 59.6914 34.496 62.6572C37.4141 65.8615 40.9761 68.4156 44.9496 70.1527C49.2731 72.0546 53.9497 73.0247 58.6742 72.9995C63.3988 73.0084 68.0722 72.023 72.3898 70.1076C76.3593 68.3559 79.9173 65.7933 82.8344 62.5851C85.5503 59.6079 87.5868 56.0777 88.8034 52.2382C89.9696 48.5193 90.2887 44.5871 89.7373 40.7292C89.2118 37.0328 87.9145 33.4878 85.9294 30.3238C84.0898 27.3802 81.7366 24.7897 78.9814 22.6751H78.9904L50.8735 1.11206L50.8013 1.058C48.956 -0.356413 45.8565 -0.351909 43.8262 1.06701C41.7734 2.49945 41.5388 4.86882 43.366 6.35981L43.357 6.36882L55.0874 15.8914L19.3412 15.9274H19.2961C16.3409 15.9319 13.4985 17.8643 12.9345 20.3148C12.3616 22.8058 14.3648 24.8688 17.4372 24.8824V24.8914L35.5517 24.8598L3.22085 49.6346L3.09903 49.7247C0.0491192 52.0581 -0.934432 55.9319 0.983042 58.3869C2.9321 60.8824 7.07836 60.8869 10.1598 58.4004L27.8006 43.986C27.8006 43.986 27.548 45.9319 27.566 47.0986V47.1031ZM72.9041 53.6211C69.2677 57.3148 64.1785 59.4139 58.6742 59.4274C53.1564 59.4364 48.0717 57.3554 44.4308 53.6662C42.6577 51.8644 41.3493 49.7968 40.5462 47.5941C39.7734 45.4493 39.4678 43.1646 39.6498 40.8925C39.8319 38.6204 40.4974 36.4132 41.6019 34.4184C42.6999 32.4461 44.1672 30.7027 45.9241 29.2833C49.5345 26.3869 54.0338 24.82 58.6652 24.8463C63.2928 24.8065 67.7926 26.3608 71.4062 29.2472C73.1626 30.6601 74.6301 32.3974 75.7285 34.3643C76.8217 36.3329 77.4873 38.5093 77.682 40.7517C77.8831 43.0495 77.5782 45.3634 76.7887 47.531C75.946 49.8156 74.6212 51.8926 72.9041 53.6211ZM46.9167 41.049C47.0103 39.5997 47.401 38.185 48.0645 36.8926C48.728 35.6002 49.6503 34.4576 50.7742 33.5355C53.1035 31.6026 56.0425 30.5543 59.0712 30.5761C62.0981 30.5573 65.0346 31.6053 67.3637 33.5355C68.4867 34.4574 69.4084 35.5994 70.0719 36.8909C70.7354 38.1825 71.1265 39.5961 71.2213 41.0445C71.3882 44.1211 70.152 46.986 67.9728 49.1076C65.5766 51.3902 62.3829 52.6491 59.0712 52.6166C55.5386 52.6166 52.3759 51.2653 50.1606 49.1031C49.0718 48.0724 48.2183 46.8193 47.6585 45.4294C47.0987 44.0395 46.8457 42.5454 46.9167 41.049Z" fill="currentColor"/>
        </svg>
        <h1 class=" text-5xl font-bold select-none dark:text-white">Collection</h1>
    </section>
    <section class="w-full max-w-screen-xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col gap-10 justify-center items-center">
        {% if app.user and 'BAN' not in app.user.roles and 'LOCK' not in app.user.roles %}
            <a href="{{ path('create_collection') }}" class="bg-white w-[200px] text-center text-black-950 px-4 py-2 rounded-md font-semibold hover:bg-grey-200 transition">+ Create Collection</a>
        {% endif %}
        <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-8 w-full">
            {% for collection in collections %}
                <div class="md:h-[200px] h-auto rounded-2xl overflow-hidden border border-grey-700 dark:bg-grey-950 bg-white hover:border-white/30 hover:shadow-xl transition-all duration-300 dark:text-white text-black-950 flex flex-col md:flex-row ">
                    
                    <a href="{{ path('liste_show', { id: collection.id }) }}" class="md:w-1/3 w-full h-64 lg:h-auto shrink-0">
                        <img src="{{ asset('uploads/' ~ collection.image) }}"
                            alt="{{ collection.name }}"
                            class="object-cover w-full h-full transition-opacity duration-200 hover:opacity-90 border-r border-grey-800">
                    </a>

                    <div class="p-6 flex flex-col justify-between w-full ">
                        <div>
                            <a href="{{ path('liste_show', { id: collection.id }) }}"
                            class="block w-fit transition-colors relative after:content-[''] after:absolute after:left-0 after:-bottom-0.5 after:h-0.5 after:w-0 after:bg-purple-500 after:transition-all after:duration-300 hover:after:w-full hover:text-purple-500 active:scale-95 active:after:bg-purple-600">
                                <h3 class="text-2xl font-bold mb-2 truncate hover:text-purple-500 active:text-purple-600">
                                    {{ collection.name }}
                                </h3>
                            </a>
                            
                            <p class="text-sm italic text-grey-400 mb-1">
                                Par
                                {% if collection.usser is not null %}
                                    <a href="{{ path('app_profil_visiteur', { id: collection.usser.id }) }}"
                                    class="text-blue-500 hover:underline hover:text-blue-400 transition-colors">
                                        {{ collection.usser.name }}
                                    </a>
                                {% else %}
                                    <span class="text-red-400 italic">Utilisateur supprimé</span>
                                {% endif %}
                            </p>

                            <p class="text-sm text-grey-300 line-clamp-3 truncate">
                                {{ collection.description ? collection.description|nl2br|raw : 'Aucune description fournie.' }}
                            </p>
                        </div>

                        <div class="mt-4 flex justify-between text-xs text-grey-500">
                            <span class="whitespace-nowrap flex flex-row items-center justify-center gap-2">
                                <svg width="15" class="dark:text-white text-black-950 inline" viewBox="0 0 54 57" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M19.5 0H8.25V7.5H0.75V18.75H53.25V7.5H45.75V0H34.5V7.5H19.5V0Z" fill="currentColor"/>
                                    <path d="M53.25 26.25H0.75V56.25H53.25V26.25Z" fill="currentColor"/>
                                </svg>
                                {{ collection.dateCreation|date('d/m/Y') }}
                            </span>
                            <span class="whitespace-nowrap flex flex-row items-center justify-center gap-2"> 
                                <svg width="15" class=" inline" viewBox="0 0 50 46" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M7.5 33.375V43.375M10 3.375V13.375M12.5 38.375H2.5M15 8.375H5M27.5 3.375L31.882 14.4859C32.3517 15.6771 32.5868 16.2726 32.9465 16.7748C33.2653 17.22 33.655 17.6098 34.1002 17.9286C34.6022 18.2883 35.198 18.5233 36.389 18.993L47.5 23.375L36.389 27.757C35.198 28.2267 34.6022 28.4618 34.1002 28.8215C33.655 29.1403 33.2653 29.53 32.9465 29.9752C32.5868 30.4772 32.3517 31.073 31.882 32.264L27.5 43.375L23.118 32.264C22.6483 31.073 22.4132 30.4772 22.0535 29.9752C21.7347 29.53 21.345 29.1403 20.8998 28.8215C20.3978 28.4618 19.8021 28.2267 18.6109 27.757L7.5 23.375L18.6109 18.993C19.8021 18.5233 20.3978 18.2883 20.8998 17.9286C21.345 17.6098 21.7347 17.22 22.0535 16.7748C22.4132 16.2726 22.6483 15.6771 23.118 14.4859L27.5 3.375Z" stroke="yellow" stroke-width="5" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                {{ collection.favorisCount }} favoris
                            </span>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </section>
</main>
{% endblock %}
